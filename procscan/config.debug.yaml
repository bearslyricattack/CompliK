# =============================================================================
# ğŸ›¡ï¸ ProcScan æœ¬åœ°è°ƒè¯•é…ç½®æ–‡ä»¶
# =============================================================================

# =============================================================================
# ğŸ” æ‰«æå™¨æ ¸å¿ƒé…ç½® (Scanner)
# =============================================================================
scanner:
  # æœ¬åœ°å¼€å‘ç¯å¢ƒ - ä½¿ç”¨æ¨¡æ‹Ÿçš„ proc ç›®å½•è¿›è¡Œæµ‹è¯•
  proc_path: "/tmp/proc-test"

  # æœ¬åœ°è°ƒè¯•å¯ä»¥ä½¿ç”¨è¾ƒçŸ­çš„æ‰«æé—´éš”
  scan_interval: "5s"

  # æœ¬åœ°å¼€å‘ä½¿ç”¨ debug çº§åˆ«ï¼Œä¾¿äºè°ƒè¯•
  log_level: "debug"

# =============================================================================
# âš¡ è‡ªåŠ¨åŒ–å“åº”é…ç½® (Actions)
# =============================================================================
actions:
  # å‘½åç©ºé—´æ ‡ç­¾åŠŸèƒ½
  label:
    enabled: true
    data:
      clawcloud.run/status: "locked"
      scan.detected: "true"
      scan.tool: "procscan"
      scan.timestamp: "2025-10-22T16-30-00"
      security.threat.level: "high"
      response.status: "pending"

# =============================================================================
# ğŸ“¢ é€šçŸ¥æ¸ é“é…ç½® (Notifications)
# =============================================================================
notifications:
  # é£ä¹¦é€šçŸ¥é…ç½® - æœ¬åœ°è°ƒè¯•å¯ä»¥ç•™ç©ºæˆ–ä½¿ç”¨æµ‹è¯•webhook
  lark:
    # æ›¿æ¢ä¸ºæ‚¨çš„æµ‹è¯•webhookï¼Œæˆ–ç•™ç©ºä»¥ç¦ç”¨é€šçŸ¥
    webhook: ""
    timeout: "10s"
    retry_count: 1

# =============================================================================
# ğŸ” æ£€æµ‹è§„åˆ™é…ç½® (Detection Rules) - æœ¬åœ°è°ƒè¯•ç®€åŒ–ç‰ˆ
# =============================================================================
detectionRules:
  # é»‘åå•è§„åˆ™ - æœ¬åœ°æµ‹è¯•ç”¨
  blacklist:
    processes:
      # æµ‹è¯•ç”¨çš„è¿›ç¨‹åï¼ˆå¯ä»¥æ ¹æ®æ‚¨çš„æœ¬åœ°ç¯å¢ƒè°ƒæ•´ï¼‰
      - "^test-malware$"
      - "^fake-miner$"

    keywords:
      # æµ‹è¯•ç”¨çš„å…³é”®è¯
      - "test-threat"
      - "fake-attack"

    commands: []
    namespaces: []
    podNames: []

  # ç™½åå•è§„åˆ™ - æœ¬åœ°å¼€å‘å¸¸ç”¨çš„è¿›ç¨‹
  whitelist:
    processes:
      # ç³»ç»Ÿè¿›ç¨‹
      - "^kernel_task$"
      - "^launchd$"
      - "^WindowServer$"
      # å¼€å‘å·¥å…·
      - "^go$"
      - "^docker$"
      - "^kubectl$"
      - "^code$"
      # ç»ˆç«¯å’ŒShell
      - "^zsh$"
      - "^bash$"
      - "^fish$"
      - "^tmux$"

    commands:
      # å¼€å‘å‘½ä»¤
      - "go build"
      - "go run"
      - "docker build"
      - "kubectl apply"
      - "git"

    namespaces:
      # æœ¬åœ°è°ƒè¯•å¯èƒ½ç”¨åˆ°çš„å‘½åç©ºé—´
      - "^default$"
      - "^kube-system$"
      - "^procscan-test$"

    podNames:
      # æµ‹è¯•Pod
      - "^procscan-test-.*"

# =============================================================================
# ğŸ“ æœ¬åœ°è°ƒè¯•è¯´æ˜
# =============================================================================
#
# ä½¿ç”¨æ–¹æ³•:
# 1. ç¡®ä¿æœ¬åœ°æœ‰å¯ç”¨çš„ Kubernetes é›†ç¾¤ (å¦‚ Docker Desktop, minikube, k3s)
# 2. ç¡®ä¿å½“å‰ç”¨æˆ·æœ‰è¶³å¤Ÿçš„æƒé™ (kubectl auth can-i create namespace)
# 3. å¯åŠ¨è°ƒè¯•: go run cmd/procscan/main.go -config config.debug.yaml
#
# æµ‹è¯•æµç¨‹:
# 1. åˆ›å»ºæµ‹è¯•å‘½åç©ºé—´: kubectl create namespace procscan-test
# 2. åœ¨æµ‹è¯•å‘½åç©ºé—´ä¸­è¿è¡ŒåŒ…å«å¯ç–‘è¿›ç¨‹çš„Pod
# 3. è§‚å¯ŸProcScanæ˜¯å¦èƒ½æ£€æµ‹åˆ°å¨èƒå¹¶æ·»åŠ æ ‡ç­¾
# 4. æ£€æŸ¥æ ‡ç­¾: kubectl get namespace procscan-test --show-labels
#
# è°ƒè¯•æŠ€å·§:
# - ä½¿ç”¨ debug æ—¥å¿—çº§åˆ«æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯
# - å¯ä»¥è°ƒæ•´ scan_interval æ¥æ”¹å˜æ£€æµ‹é¢‘ç‡
# - å¯ä»¥ä¸´æ—¶ç¦ç”¨é€šçŸ¥åŠŸèƒ½æ¥ä¸“æ³¨äºæ ‡ç­¾åŠŸèƒ½æµ‹è¯•
# =============================================================================