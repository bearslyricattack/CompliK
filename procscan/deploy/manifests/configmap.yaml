apiVersion: v1
kind: ConfigMap
metadata:
  name: block-procscan-config
  namespace: block-system
data:
  config.yaml: |
    scanner:
      proc_path: "/host/proc"
      scan_interval: "100s"
      log_level: "debug"

    actions:
      label:
        enabled: false
        data:
          clawcloud.run/status: "locked"

    notifications:
      lark:
        webhook: ""
        timeout: "30s"
        retry_count: 3

    metrics:
      enabled: false
      port: 8080
      path: "/metrics"
      read_timeout: "10s"
      write_timeout: "10s"
      max_retries: 3
      retry_interval: "5s"

    detectionRules:
      blacklist:
        processes:
          - "^miner$"
          - "^xmrig$"
          - "^xmrig-vrl$"
          - "^argosb$"
          - "^asd$"
          - "^kdevtmpfsi$"
          - "^kinsing$"
          - "^crypto-miner$"
          - "^ccminer$"
          - "^cpuminer$"
          - "^bfgminer$"
          - "^nsgminer$"
          - "^teamredminer$"
          - "^nbminer$"
          - "^t-rex$"
          - "^bash.*reverse.*shell"
          - "^nc.*-l.*-p"
          - "^socat.*TCP-LISTEN"
          - "^python.*socket.*"
          - "^perl.*socket.*"
          - "^masscan$"
          - "^nmap$"
          - "^sqlmap$"
          - "^nikto$"
          - "^hydra$"

        keywords:
          - "stratum+tcp"
          - "pool."
          - "monero"
          - "cryptonight"
          - "ethash"
          - "scrypt"
          - "wallet"
          - "donate-level"
          - "reverse shell"
          - "bind shell"
          - "port scan"
          - "ddos"
          - "botnet"
          - "password"
          - "shadow"
          - "/etc/passwd"
          - "/etc/shadow"
          - "rootkit"
          - "backdoor"
        commands: []
        namespaces: []
        podNames: []

      whitelist:
        processes:
          - "^kubelet$"
          - "^kube-proxy$"
          - "^containerd$"
          - "^containerd-shim$"
          - "^dockerd$"
          - "^docker-proxy$"
          - "^runc$"
          - "^crictl$"
          - "^nerdctl$"
          - "^init$"
          - "^systemd$"
          - "^bash$"
          - "^sh$"
          - "^zsh$"
          - "^dash$"
          - "^ksh$"
          - "^tcsh$"
          - "^csh$"
          - "^fish$"
          - "^busybox$"
          - "^coreutils$"
          - "^util-linux$"
          - "^procps$"
          - "^prometheus-node-exporter$"
          - "^fluentd$"
          - "^filebeat$"
          - "^metricbeat$"
          - "^jaeger-agent$"
          - "^istio-proxy$"
          - "^envoy$"
          - "^linkerd-proxy$"
          - "^java$"
          - "^node$"

        commands:
          - "apt-get"
          - "yum"
          - "dnf"
          - "pacman"
          - "systemctl"
          - "service"
          - "journalctl"
          - "git"
          - "make"
          - "cmake"
          - "gcc"
          - "mvn"
          
        namespaces:
          - "^kube-system$"

        podNames:
          - "^coredns-.*"
          - "^etcd-.*"
          - "^kube-apiserver-.*"
          - "^kube-controller-manager-.*"
          - "^kube-scheduler-.*"
          - "^kube-proxy-.*"
          - "^fluentd-.*"
          - "^node-exporter-.*"
          - "^prometheus-.*"