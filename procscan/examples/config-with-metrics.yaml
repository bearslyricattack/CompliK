# ProcScan 配置文件示例（包含 Metrics 配置）
scanner:
  proc_path: "/host/proc"
  scan_interval: "10s"
  log_level: "info"

# 自动化动作配置
actions:
  label:
    enabled: true
    data:
      clawcloud.run/status: "locked"
      security.scan/timestamp: ""

# 通知配置
notifications:
  lark:
    webhook: ""

# Prometheus 指标配置
metrics:
  enabled: true                  # 启用指标服务器
  port: 8080                    # 指标服务器端口
  path: "/metrics"              # 指标暴露路径
  read_timeout: "10s"           # 读取超时
  write_timeout: "10s"          # 写入超时
  max_retries: 3                # 启动重试次数
  retry_interval: "5s"          # 重试间隔

# 检测规则配置
detectionRules:
  blacklist:
    processes: []
    keywords:
      - "kdevtmpfsi"
      - "kinsing"
      - "bash"
      - "sh"
      - "wget"
      - "curl"
    commands:
      - "stratum+tcp://"
      - "pool.example.com"
      - "crypto-mining"
    namespaces: []
    podNames: []
  whitelist:
    processes:
      - "pause"
      - "containerd-shim"
      - "qemu"
      - "kubelet"
      - "docker"
      - "containerd"
    keywords: []
    commands: []
    namespaces:
      - "kube-system"
      - "block-system"
    podNames: []