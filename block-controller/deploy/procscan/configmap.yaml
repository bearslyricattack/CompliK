# ConfigMap
apiVersion: v1
kind: ConfigMap
metadata:
  name: block-procscan-config
  namespace: block-system
data:
  config.yaml: |
    # Scanner configuration
    scanner:
      proc_path: "/host/proc"
      scan_interval: "100s"
      log_level: "info"

    # Automated actions configuration
    actions:
      label:
        enabled: true
        data:
          clawcloud.run/status: "locked"
      forceDelete:
        enabled: true # Disabled by default to ensure security

    # Notification channel configuration
    notifications:
      lark:
        webhook: "https://open.feishu.cn/open-apis/bot/v2/hook/de0df867-9457-49be-a747-e01274a319cc"

    # Detection rules configuration
    detectionRules:
      blacklist:
        processes:
          - "^miner$" # Exact match for miner
          - "^xmrig$"
          - "^xmrig-vrl$"
          - "^argosb$"
          - "^asd$"
        keywords:
      whitelist:
        processes:
        commands:
        namespaces:
        podNames:
